<!DOCTYPE HTML>  
<html>
<head>
    <meta charset="utf-8" />
    <title>websocket chat</title>  
    <style type="text/css">
        
    </style>
</head>
<body>
    <input id="input" style="width:400px"/>
    
    <script type="text/javascript">
       window.onload = function(){
            var nick = prompt('Enter your nick name:');
            var input = document.getElementById('input');
            input.focus();

            socket = new WebSocket("ws://"+ window.location.host +"/");

            //获取服务器发送来的消息动态插入页面中
            socket.onmessage = function(event){
                var msg = event.data;
                var node = document.createTextNode(msg);
                var div = document.createElement('div');
                div.appendChild(node);
                document.insertBefore(div,input);
                input.scrollIntoView();
            }

            //发送用户输入消息到服务器
            input.onchange = function(){
                var msg = nick + ':' +input.value;
                socket.send(msg);
                input.value = '';
            }
       }
    </script>
</body>
</html>

